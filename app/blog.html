<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>All Signals — WaveSignals</title>
    <meta name="description" content="Browse the complete archive of WaveSignals insights." />
    <meta name="robots" content="index,follow" />

    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/styles/main.css">
</head>

<body>

    <header class="site-header">
        <div class="container header-inner">
            <div class="brand-container">
                <a href="/app/index.html" class="home-link">
                    <img src="/public/logo-header.svg" alt="WaveSignals" class="site-logo">
                </a>
            </div>

            <nav class="main-nav">
                <ul class="nav-list">
                    <li><a href="/app/index.html" class="nav-link">Home</a></li>
                    <li><a href="/app/blog.html" class="nav-link" style="color:#fff;">Signals</a></li>
                    <li><a href="/contact.html" class="nav-link">Contact</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="site-main">
        <div class="container">

            <div style="text-align:center; padding: 4rem 0 2rem;">
                <h1 style="font-family:'Outfit', sans-serif; font-size:2.5rem; margin-bottom:1rem; color:#fff;">Signals
                    Archive</h1>
                <p class="page-subtitle">Explore our library of insights.</p>

                <!-- SEARCH BAR -->
                <div class="search-box">
                    <input type="text" id="search-input" placeholder="Search signals..." onkeyup="filterPosts()">
                </div>
            </div>

            <ul class="posts-list" id="posts-list">
                <!-- Posts injected here -->
                <li style="text-align:center; color:var(--text-muted);">Loading...</li>
            </ul>

        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>© 2025 WaveSignals. • <a href="/privacy.html">Privacy</a> • <a href="/terms.html">Terms</a></p>
        </div>
    </footer>

    <script src="/scripts/main.js"></script>
    <script>
        let allPosts = [];

        async function loadPosts() {
            const list = document.getElementById("posts-list");
            try {
                // Fetch from API (or local json if static)
                // Note: In production static site, this might fetch from /data/posts.json
                // In local dev, /api/posts. 
                // We'll try /data/posts.json for static compatibility
                const res = await fetch('/data/posts.json');
                if (!res.ok) throw new Error("Failed to load");

                const data = await res.json();
                const posts = Array.isArray(data.posts) ? data.posts : [];

                // Filter only published
                allPosts = posts.filter(p => p.published === true);

                renderPosts(allPosts);
            } catch (err) {
                console.error(err);
                list.innerHTML = "<li style='text-align:center;'>Unable to load archive.</li>";
            }
        }

        function renderPosts(posts) {
            const list = document.getElementById("posts-list");
            if (!posts.length) {
                list.innerHTML = "<li style='grid-column: 1/-1; text-align:center;'>No signals found.</li>";
                return;
            }

            list.innerHTML = "";
            posts.forEach(post => {
                const li = document.createElement("li");
                li.className = "post-item";

                li.innerHTML = `
            <a href="/app/post.html?slug=${encodeURIComponent(post.slug)}" class="post-link">
              <article>
                <h2 class="post-title">${post.title}</h2>
                <p class="post-excerpt">${post.excerpt || ""}</p>
                <div class="post-meta">
                  <time datetime="${post.date}">
                    ${new Date(post.date).toDateString()}
                  </time>
                  <span>•</span>
                  <span>${post.author || "WaveSignals Team"}</span>
                </div>
              </article>
            </a>
          `;
                list.appendChild(li);
            });
        }

        function filterPosts() {
            const query = document.getElementById('search-input').value.toLowerCase();
            const filtered = allPosts.filter(p =>
                p.title.toLowerCase().includes(query) ||
                (p.excerpt && p.excerpt.toLowerCase().includes(query))
            );
            renderPosts(filtered);
        }

        // Init
        loadPosts();
    </script>
</body>

</html>